BNCparse
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

Quirin Würschinger, LMU Munich

<q.wuerschinger@lmu.de>

## Data overview

<div>

<p>

<img src="index_files/figure-commonmark/mermaid-figure-1.png"
style="width:7in;height:8.08in" />

</p>

</div>

# Load packages

Package requirements are stored in `requirements.yml`.

# Variables

BNC2014 needs to be downloaded for this script to work. It can be
obtained from the official [BNC
website](http://corpora.lancs.ac.uk/bnc2014/).

The following variables need to be updated to the corpus’ local path. In
the current setting the BNC2014 data were stored in the project folder
in the folder `data/bnc-2014-spoken`.

For development, I use a small subset of the corpus contained in
`data/test` that only contains the first 10 texts.

``` python
testing = True

if testing:
    path_bnc = Path('../data/test/bnc-2014-spoken')
    texts_n = 10
    tokens_n = 94_659
else:
    path_bnc = Path('../data/bnc-2014-spoken')
    texts_n = 1251
    tokens_n = 11_422_615
```

``` python
path_corpus = Path(path_bnc / 'spoken' / 'tagged')
path_metadata = Path(path_bnc / 'spoken' / 'metadata')
```

``` python
assert path_bnc.exists()
assert path_corpus.exists()
assert path_metadata.exists()
```

# Load and parse XML

``` python
path_texts = list(path_corpus.glob('*.xml'))
```

``` python
assert len(path_texts) == texts_n
```

------------------------------------------------------------------------

<a
href="https://github.com/wuqui/bncparse/blob/main/bncparse/core.py#L15"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_xml

>      get_xml (f_path)

``` python
texts = [get_xml(path) for path in path_texts]
```

# Corpus statistics

## Texts

Calculate the total number of texts in the corpus.

``` python
text_ids = [xml.get('id') for xml in texts]

print(f"number of documents in the corpus: {len(text_ids)}")
```

    number of documents in the corpus: 10

``` python
assert len(text_ids) == texts_n
```

## Speakers

1.  Determine all speakers in the corpus.
2.  Calculate the total number of words each speaker has contributed to
    the corpus.

``` python
speakers_words = defaultdict(int)
for text in texts:
    for u in text.iter('u'):
        speaker = u.get('who')
        n_words = len([w for w in u.iter('w')])
        speakers_words[speaker] += n_words
```

### Number of speakers

``` python
print(f"number of speakers: {len(speakers_words)}")
```

    number of speakers: 24

### Words per speaker

``` python
df_speakers_tokens = pd.DataFrame(
    list(speakers_words.items()), columns=['speaker', 'tokens'])
df_speakers_tokens = df_speakers_tokens.sort_values('tokens', ascending=False)
df_speakers_tokens
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>speaker</th>
      <th>tokens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>S0336</td>
      <td>14332</td>
    </tr>
    <tr>
      <th>21</th>
      <td>S0362</td>
      <td>11261</td>
    </tr>
    <tr>
      <th>16</th>
      <td>S0115</td>
      <td>7522</td>
    </tr>
    <tr>
      <th>17</th>
      <td>S0037</td>
      <td>6970</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S0623</td>
      <td>6621</td>
    </tr>
    <tr>
      <th>11</th>
      <td>S0024</td>
      <td>5086</td>
    </tr>
    <tr>
      <th>5</th>
      <td>S0611</td>
      <td>4698</td>
    </tr>
    <tr>
      <th>10</th>
      <td>S0144</td>
      <td>4183</td>
    </tr>
    <tr>
      <th>14</th>
      <td>S0687</td>
      <td>3810</td>
    </tr>
    <tr>
      <th>22</th>
      <td>S0261</td>
      <td>3596</td>
    </tr>
    <tr>
      <th>15</th>
      <td>S0688</td>
      <td>2987</td>
    </tr>
    <tr>
      <th>13</th>
      <td>S0689</td>
      <td>2832</td>
    </tr>
    <tr>
      <th>0</th>
      <td>S0567</td>
      <td>2784</td>
    </tr>
    <tr>
      <th>18</th>
      <td>S0030</td>
      <td>2622</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S0620</td>
      <td>2488</td>
    </tr>
    <tr>
      <th>19</th>
      <td>S0096</td>
      <td>2261</td>
    </tr>
    <tr>
      <th>9</th>
      <td>S0441</td>
      <td>2129</td>
    </tr>
    <tr>
      <th>8</th>
      <td>S0439</td>
      <td>2032</td>
    </tr>
    <tr>
      <th>23</th>
      <td>S0262</td>
      <td>1863</td>
    </tr>
    <tr>
      <th>6</th>
      <td>S0680</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>12</th>
      <td>S0690</td>
      <td>1782</td>
    </tr>
    <tr>
      <th>7</th>
      <td>S0679</td>
      <td>848</td>
    </tr>
    <tr>
      <th>4</th>
      <td>UNKFEMALE</td>
      <td>91</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UNKMULTI</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>

The table containing all speakers and their total token counts can be
found in `speakers_tokens.csv`.

``` python
if not testing:
    df_speakers_tokens.to_csv('../out/speakers_tokens.csv', index=False)
```

## Vocabulary

``` python
tokens = []
for text in texts:
    for w in text.iter('w'):
        tokens.append(w.text)
```

``` python
n_toks_types = pd.DataFrame(
    {'tokens': f'{len(tokens):,}', 
    'types': f'{len(set(tokens)):,}'}, 
    index=[0]
)

n_toks_types
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tokens</th>
      <th>types</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>94,659</td>
      <td>5,334</td>
    </tr>
  </tbody>
</table>
</div>

# Export corpus data in tabular format

In addition to the metadata present in the corpus, I’ve added three
columns providing positional information about the tokens:

- `u_toks`: total number of tokens in the given utterance
- `w_idx`: token position (‘index’) in the given utterance, starting at
  1
- `w_idx_rel`: relative token position in the given utterance:
  `w_idx / u_toks`

``` python
tokens = []

for text in texts:
    for u in text.findall('u'):
        for i, w in enumerate(u.iter('w')):
            tok_d = {}

            tok_d['text_id'] = text.get('id')

            tok_d['u_n'] = u.get('n')
            tok_d['u_who'] = u.get('who')
            tok_d['u_trans'] = u.get('trans')
            tok_d['u_whoConfidence'] = u.get('whoConfidence')
            tok_d['u_toks'] = len(list(u.iter('w')))

            tok_d['w_pos'] = w.get('pos')
            tok_d['w_lemma'] = w.get('lemma')
            tok_d['w_class'] = w.get('class')
            tok_d['w_usas'] = w.get('usas')
            tok_d['w_text'] = w.text
            tok_d['w_idx'] = i + 1
            tok_d['w_idx_rel'] = round(tok_d['w_idx'] / tok_d['u_toks'], 2)

            tokens.append(tok_d)
```

    CPU times: user 700 ms, sys: 79.4 ms, total: 780 ms
    Wall time: 794 ms

``` python
tokens = pd.DataFrame(tokens)
```

    CPU times: user 147 ms, sys: 18.8 ms, total: 166 ms
    Wall time: 166 ms

``` python
tokens.head(50)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text_id</th>
      <th>u_n</th>
      <th>u_who</th>
      <th>u_trans</th>
      <th>u_whoConfidence</th>
      <th>u_toks</th>
      <th>w_pos</th>
      <th>w_lemma</th>
      <th>w_class</th>
      <th>w_usas</th>
      <th>w_text</th>
      <th>w_idx</th>
      <th>w_idx_rel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>VM</td>
      <td>shall</td>
      <td>VERB</td>
      <td>T1:1:3</td>
      <td>shall</td>
      <td>1</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>PPIS1</td>
      <td>i</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>I</td>
      <td>2</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>VVI</td>
      <td>move</td>
      <td>VERB</td>
      <td>M2</td>
      <td>move</td>
      <td>3</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>AT</td>
      <td>the</td>
      <td>ART</td>
      <td>Z5</td>
      <td>the</td>
      <td>4</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>NN2</td>
      <td>laptop</td>
      <td>SUBST</td>
      <td>Y2</td>
      <td>laptops</td>
      <td>5</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>5</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>RT</td>
      <td>then</td>
      <td>ADV</td>
      <td>N4</td>
      <td>then</td>
      <td>6</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>6</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>VV0</td>
      <td>stick</td>
      <td>VERB</td>
      <td>M2</td>
      <td>stick</td>
      <td>7</td>
      <td>0.58</td>
    </tr>
    <tr>
      <th>7</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>PPH1</td>
      <td>it</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>it</td>
      <td>8</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>8</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>II</td>
      <td>on</td>
      <td>PREP</td>
      <td>N6</td>
      <td>on</td>
      <td>9</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>9</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>AT</td>
      <td>the</td>
      <td>ART</td>
      <td>N6</td>
      <td>the</td>
      <td>10</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>10</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>NN1</td>
      <td>table</td>
      <td>SUBST</td>
      <td>N6</td>
      <td>table</td>
      <td>11</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>11</th>
      <td>S2EF</td>
      <td>1</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>12</td>
      <td>YQUE</td>
      <td>PUNC</td>
      <td>STOP</td>
      <td></td>
      <td>?</td>
      <td>12</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>UH</td>
      <td>yeah</td>
      <td>INTERJ</td>
      <td>Z4</td>
      <td>yeah</td>
      <td>1</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>VD0</td>
      <td>do</td>
      <td>VERB</td>
      <td>Z5</td>
      <td>do</td>
      <td>2</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>14</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>PPIS2</td>
      <td>we</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>we</td>
      <td>3</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th>15</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>VVI</td>
      <td>want</td>
      <td>VERB</td>
      <td>X7</td>
      <td>want</td>
      <td>4</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>16</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>NN2</td>
      <td>plate</td>
      <td>SUBST</td>
      <td>O2</td>
      <td>plates</td>
      <td>5</td>
      <td>0.62</td>
    </tr>
    <tr>
      <th>17</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>CC</td>
      <td>or</td>
      <td>CONJ</td>
      <td>Z5</td>
      <td>or</td>
      <td>6</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>18</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>UH</td>
      <td>no</td>
      <td>INTERJ</td>
      <td>Z4</td>
      <td>no</td>
      <td>7</td>
      <td>0.88</td>
    </tr>
    <tr>
      <th>19</th>
      <td>S2EF</td>
      <td>2</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>8</td>
      <td>YQUE</td>
      <td>PUNC</td>
      <td>STOP</td>
      <td></td>
      <td>?</td>
      <td>8</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>20</th>
      <td>S2EF</td>
      <td>3</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>1</td>
      <td>UH</td>
      <td>no</td>
      <td>INTERJ</td>
      <td>Z4</td>
      <td>no</td>
      <td>1</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>S2EF</td>
      <td>5</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>UH</td>
      <td>no</td>
      <td>INTERJ</td>
      <td>Z4</td>
      <td>no</td>
      <td>1</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>22</th>
      <td>S2EF</td>
      <td>5</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>VV0</td>
      <td>get</td>
      <td>VERB</td>
      <td>A2:1</td>
      <td>get</td>
      <td>2</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>23</th>
      <td>S2EF</td>
      <td>5</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>JJ</td>
      <td>stuck</td>
      <td>ADJ</td>
      <td>A1:7</td>
      <td>stuck</td>
      <td>3</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>24</th>
      <td>S2EF</td>
      <td>5</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>II</td>
      <td>in</td>
      <td>PREP</td>
      <td>Z5</td>
      <td>in</td>
      <td>4</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>25</th>
      <td>S2EF</td>
      <td>6</td>
      <td>S0567</td>
      <td>overlap</td>
      <td>high</td>
      <td>3</td>
      <td>PPIS2</td>
      <td>we</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>we</td>
      <td>1</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th>26</th>
      <td>S2EF</td>
      <td>6</td>
      <td>S0567</td>
      <td>overlap</td>
      <td>high</td>
      <td>3</td>
      <td>VBR</td>
      <td>be</td>
      <td>VERB</td>
      <td>A3</td>
      <td>'re</td>
      <td>2</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>27</th>
      <td>S2EF</td>
      <td>6</td>
      <td>S0567</td>
      <td>overlap</td>
      <td>high</td>
      <td>3</td>
      <td>NN2</td>
      <td>savage</td>
      <td>SUBST</td>
      <td>S1:1:1</td>
      <td>savages</td>
      <td>3</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>S2EF</td>
      <td>7</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>PNQS</td>
      <td>who</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>who</td>
      <td>1</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>29</th>
      <td>S2EF</td>
      <td>7</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>VVZ</td>
      <td>need</td>
      <td>VERB</td>
      <td>S6</td>
      <td>needs</td>
      <td>2</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>30</th>
      <td>S2EF</td>
      <td>7</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>NN2</td>
      <td>plate</td>
      <td>SUBST</td>
      <td>O2</td>
      <td>plates</td>
      <td>3</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>31</th>
      <td>S2EF</td>
      <td>7</td>
      <td>S0620</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>4</td>
      <td>YQUE</td>
      <td>PUNC</td>
      <td>STOP</td>
      <td></td>
      <td>?</td>
      <td>4</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>32</th>
      <td>S2EF</td>
      <td>8</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>6</td>
      <td>UH</td>
      <td>oh</td>
      <td>INTERJ</td>
      <td>Z4</td>
      <td>oh</td>
      <td>1</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>33</th>
      <td>S2EF</td>
      <td>8</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>6</td>
      <td>APPGE</td>
      <td>my</td>
      <td>PRON</td>
      <td>Z4</td>
      <td>my</td>
      <td>2</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th>34</th>
      <td>S2EF</td>
      <td>8</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>6</td>
      <td>NN1</td>
      <td>god</td>
      <td>SUBST</td>
      <td>Z4</td>
      <td>god</td>
      <td>3</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>35</th>
      <td>S2EF</td>
      <td>8</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>6</td>
      <td>PPH1</td>
      <td>it</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>it</td>
      <td>4</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>36</th>
      <td>S2EF</td>
      <td>8</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>6</td>
      <td>VVZ</td>
      <td>smell</td>
      <td>VERB</td>
      <td>X3:5</td>
      <td>smells</td>
      <td>5</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>37</th>
      <td>S2EF</td>
      <td>8</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>6</td>
      <td>JJ</td>
      <td>amazing</td>
      <td>ADJ</td>
      <td>O4:2</td>
      <td>amazing</td>
      <td>6</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>38</th>
      <td>S2EF</td>
      <td>9</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>2</td>
      <td>PPIS1</td>
      <td>i</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>I</td>
      <td>1</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>39</th>
      <td>S2EF</td>
      <td>9</td>
      <td>S0567</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>2</td>
      <td>VV0</td>
      <td>know</td>
      <td>VERB</td>
      <td>X2:2</td>
      <td>know</td>
      <td>2</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>40</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>PPH1</td>
      <td>it</td>
      <td>PRON</td>
      <td>Z8</td>
      <td>it</td>
      <td>1</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>41</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>VBZ</td>
      <td>be</td>
      <td>VERB</td>
      <td>A3</td>
      <td>'s</td>
      <td>2</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>42</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>XX</td>
      <td>not</td>
      <td>ADV</td>
      <td>Z6</td>
      <td>not</td>
      <td>3</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>43</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>DB</td>
      <td>all</td>
      <td>ADJ</td>
      <td>N5:1</td>
      <td>all</td>
      <td>4</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th>44</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>VVGK</td>
      <td>going</td>
      <td>VERB</td>
      <td>T1:1:3</td>
      <td>gon</td>
      <td>5</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>45</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>TO</td>
      <td>to</td>
      <td>PREP</td>
      <td>Z5</td>
      <td>na</td>
      <td>6</td>
      <td>0.60</td>
    </tr>
    <tr>
      <th>46</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>VVI</td>
      <td>fit</td>
      <td>VERB</td>
      <td>N3:2</td>
      <td>fit</td>
      <td>7</td>
      <td>0.70</td>
    </tr>
    <tr>
      <th>47</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>II</td>
      <td>on</td>
      <td>PREP</td>
      <td>Z5</td>
      <td>on</td>
      <td>8</td>
      <td>0.80</td>
    </tr>
    <tr>
      <th>48</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>MC1</td>
      <td>one</td>
      <td>ADJ</td>
      <td>N1</td>
      <td>one</td>
      <td>9</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>49</th>
      <td>S2EF</td>
      <td>10</td>
      <td>S0623</td>
      <td>nonoverlap</td>
      <td>high</td>
      <td>10</td>
      <td>NN1</td>
      <td>table</td>
      <td>SUBST</td>
      <td>H5</td>
      <td>table</td>
      <td>10</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>

``` python
assert len(tokens) == tokens_n
```

I export the full token table to `tokens.csv`.

``` python
if not testing:
    tokens.to_csv('../out/tokens.csv', index=False)
```

I also export a smaller version for use in spreadsheet software. This
version contains the first 50,000 tokens in the corpus and is stored in
`tokens_50k.csv`.

``` python
if not testing:
    (tokens
     .head(50_000)
     .to_csv('../out/tokens_50k.csv', index=False))
```
